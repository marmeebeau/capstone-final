{"ast":null,"code":"// src/services/authServices.js\nimport axios from'axios';const API_URL='http://localhost:1337/api';// Adjust if Strapi is hosted elsewhere\n// Set authorization token in axios headers\nexport const setAuthToken=token=>{if(token){axios.defaults.headers.common['Authorization']=`Bearer ${token}`;}else{delete axios.defaults.headers.common['Authorization'];}};// Register a new coordinator\nexport const signup=async formData=>{try{const response=await axios.post(`${API_URL}/coordinators/register`,{data:formData});if(response.data.jwt){localStorage.setItem('user',JSON.stringify(response.data));// Store user data with JWT\nsetAuthToken(response.data.jwt);// Set token for future requests\n}return response.data;}catch(error){var _error$response,_error$response$data,_error$response$data$;console.error('Signup error:',error);const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:(_error$response$data$=_error$response$data.error)===null||_error$response$data$===void 0?void 0:_error$response$data$.message)||'Signup failed. Please try again.';throw new Error(errorMessage);}};// Login a user (coordinator or admin)\nexport const login=async(identifier,password)=>{try{const response=await axios.post(`${API_URL}/coordinators/login`,{identifier,password});const{coordinator,token}=response.data;// Ensure response contains 'coordinator' and 'token'\nlocalStorage.setItem('token',token);localStorage.setItem('user',JSON.stringify({coordinator}));// Store 'coordinator' in user\nsetAuthToken(token);// Set token for future requests\nreturn{coordinator,token};// Return structured data\n}catch(error){console.error('Login failed:',error);throw new Error('Login failed. Please check your credentials.');}};// Logout a user\nexport const logout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');setAuthToken(null);// Clear token from headers\n};// Get current authenticated user from localStorage\nexport const getCurrentUser=()=>{const user=localStorage.getItem('user');return user?JSON.parse(user):null;};// Check if a user is authenticated by checking the presence of a token\nexport const isAuthenticated=()=>{const user=getCurrentUser();return user&&user.jwt?true:false;};// Get the user profile by ID\nexport const getProfile=async userId=>{try{const response=await axios.get(`${API_URL}/coordinators/${userId}`,{headers:{Authorization:`Bearer ${getCurrentUser().jwt}`}});return response.data;}catch(error){console.error('Error fetching profile:',error);throw new Error('Failed to fetch profile data');}};// Update the user profile\nexport const updateProfile=async(userId,profileData)=>{try{setAuthToken(getCurrentUser().jwt);const response=await axios.put(`${API_URL}/coordinators/${userId}`,{data:profileData});return response.data;}catch(error){var _error$response2,_error$response2$data;console.error('Error updating profile:',error);throw new Error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message||'An error occurred. Please try again.');}};// Export all services\nconst authServices={signup,login,logout,getCurrentUser,isAuthenticated,getProfile,updateProfile,setAuthToken};export default authServices;","map":{"version":3,"names":["axios","API_URL","setAuthToken","token","defaults","headers","common","signup","formData","response","post","data","jwt","localStorage","setItem","JSON","stringify","error","_error$response","_error$response$data","_error$response$data$","console","errorMessage","message","Error","login","identifier","password","coordinator","logout","removeItem","getCurrentUser","user","getItem","parse","isAuthenticated","getProfile","userId","get","Authorization","updateProfile","profileData","put","_error$response2","_error$response2$data","authServices"],"sources":["C:/Users/marmeeluv/Desktop/capstone-final/frontend/src/services/authServices.js"],"sourcesContent":["// src/services/authServices.js\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:1337/api'; // Adjust if Strapi is hosted elsewhere\r\n\r\n// Set authorization token in axios headers\r\nexport const setAuthToken = (token) => {\r\n  if (token) {\r\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n  } else {\r\n    delete axios.defaults.headers.common['Authorization'];\r\n  }\r\n};\r\n\r\n// Register a new coordinator\r\nexport const signup = async (formData) => {\r\n  try {\r\n    const response = await axios.post(`${API_URL}/coordinators/register`, { data: formData });\r\n    if (response.data.jwt) {\r\n      localStorage.setItem('user', JSON.stringify(response.data)); // Store user data with JWT\r\n      setAuthToken(response.data.jwt); // Set token for future requests\r\n    }\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Signup error:', error);\r\n    const errorMessage = error.response?.data?.error?.message || 'Signup failed. Please try again.';\r\n    throw new Error(errorMessage);\r\n  }\r\n};\r\n\r\n// Login a user (coordinator or admin)\r\nexport const login = async (identifier, password) => {\r\n  try {\r\n      const response = await axios.post(`${API_URL}/coordinators/login`, { identifier, password });\r\n      const { coordinator, token } = response.data; // Ensure response contains 'coordinator' and 'token'\r\n\r\n      localStorage.setItem('token', token);\r\n      localStorage.setItem('user', JSON.stringify({ coordinator })); // Store 'coordinator' in user\r\n\r\n      setAuthToken(token); // Set token for future requests\r\n      return { coordinator, token }; // Return structured data\r\n  } catch (error) {\r\n      console.error('Login failed:', error);\r\n      throw new Error('Login failed. Please check your credentials.');\r\n  }\r\n};\r\n\r\n// Logout a user\r\nexport const logout = () => {\r\n  localStorage.removeItem('token');\r\n  localStorage.removeItem('user');\r\n  setAuthToken(null); // Clear token from headers\r\n};\r\n\r\n// Get current authenticated user from localStorage\r\nexport const getCurrentUser = () => {\r\n  const user = localStorage.getItem('user');\r\n  return user ? JSON.parse(user) : null;\r\n};\r\n\r\n// Check if a user is authenticated by checking the presence of a token\r\nexport const isAuthenticated = () => {\r\n  const user = getCurrentUser();\r\n  return user && user.jwt ? true : false;\r\n};\r\n\r\n// Get the user profile by ID\r\nexport const getProfile = async (userId) => {\r\n  try {\r\n    const response = await axios.get(`${API_URL}/coordinators/${userId}`, {\r\n      headers: { Authorization: `Bearer ${getCurrentUser().jwt}` },\r\n    });\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error fetching profile:', error);\r\n    throw new Error('Failed to fetch profile data');\r\n  }\r\n};\r\n\r\n// Update the user profile\r\nexport const updateProfile = async (userId, profileData) => {\r\n  try {\r\n    setAuthToken(getCurrentUser().jwt);\r\n    const response = await axios.put(`${API_URL}/coordinators/${userId}`, { data: profileData });\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error updating profile:', error);\r\n    throw new Error(error.response?.data?.message || error.message || 'An error occurred. Please try again.');\r\n  }\r\n};\r\n\r\n// Export all services\r\nconst authServices = {\r\n  signup,\r\n  login,\r\n  logout,\r\n  getCurrentUser,\r\n  isAuthenticated,\r\n  getProfile,\r\n  updateProfile,\r\n  setAuthToken,\r\n};\r\n\r\nexport default authServices;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}